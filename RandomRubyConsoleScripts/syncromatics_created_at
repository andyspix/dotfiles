devs = Device.where(mdn: %w(4082121238 4082121286 4082121372 4082121523 4082203381 4082205772 4082205884 4083091632 4083165664 4083180634 4083349673 4083349924 4084200819 4084700626 4084709359 4084720802 4084720926 4084722017 4084722408 4084722460 4084722656 4084723918 4084723923 4084724196 4084725377 4084725445 4084726214 4084726904 4084727593 4084728823 4084729117 4084729173 4084820481 4084821282 4084826639 4084827116 4084828701 4084829064 4084829527 4084829591 4084832458 4084832710 4084832923 4084833736 4084834488 4084835532 4084836436 4084837232 4084837920 4084838015 4084838042 4084838880 4084839792 4084890786 4084893173 4084893802 4084894143 4084895490 4084896764 4084896787 4084897377 4084897531 4084959312 4084959413 4084959729 4084971418 4084972008 4084976176 4084976575 4084976745 4084977164 4084977462 4084978038 4084979536 4084991402 4084991620 4084992404 4084994365 4084997941 4084998845 4085100616 4085101477 4085101664 4085101677 4085102138 4085102616 4085102651 4085102947 4085104522 4085104734 4085108976 4085109139 4085109786 4085124137 4085175039 4085175130 4085175690 4085175728 4085292108 4085292408 4085293030 4085293380 4085297056 4085297692 4085297739 4085297782 4085680774 4085681460 4085681502 4085682319 4085682507 4085683011 4085685389 4085946427 4085946956 4085980637 4085985141 4085989008 4085989033 4086058223 4086363192 4086633318 4086646414 4086646415 4086646416 4086646417 4086646547 4086646667 4086646995 4086648231 4086648297 4087017565 4087020435 4087020650 4087020717 4087028992 4087310112 4087310420 4087310434 4087310446 4087310752 4087310765 4087310872 4087346258 4087346280 4087346353 4087346360 4087346382 4087346383 4087346405 4087346410 4087346439 4087346484 4087346496 4087346634 4087346670 4087346671 4087346673 4087346674 4087346675 4087346676 4087346677 4087346678 4087346679 4087346680 4087346681 4087346682 4087346683 4087346684 4087346685 4087346718 4087346719 4087346747 4087346791 4087346792 4087346793 4087346794 4087346809 4087346837 4087346843 4087346846 4087346847 4087346848 4087346849 4087346850 4087346851 4087346852 4087346853 4087346854 4087346855 4087346856 4087346857 4087346858 4087346859 4087346860 4087346861 4087346867 4087346868 4087346869 4087346870 4087346871 4087346872 4087346885 4087346886 4087346887 4087346888 4087346889 4087346890 4087346891 4087346892 4087346893 4087346894 4087346895 4087346896 4087346967 4087477239 4087477250 4087477302 4087479176 4087479200 4087479401 4087479513 4087479680 4087479942 4087690011 4087690028 4087690199 4087690210 4087690234 4087690235 4087690504 4087690730 4087690750 4087690809 4087690913 4087690957 4087690986 4087691127 4087691269 4087691291 4087691312 4087691313 4087691314 4087691544 4087691559 4087691645 4087691649 4087691766 4087691782 4087691803 4087691827 4087698248 4087698267 4087698325 4087698326 4087698554 4087698577 4087698669 4087698717 4087698796 4087698799 4087698806 4087698832 4087698834 4087698852 4087698853 4087698959 4087698960 4087698961 4087698962 4087698963 4087698964 4087698965 4087698966 4087698967 4087698968 4087698969 4087698970 4087698971 4087698984 4087698985 4087698986 4087698989 4087698990 4087698992 4087698993 4087698995 4087698996 4087698997 4087699006 4087699017 4087699018 4087699019 4087699020 4087699023 4087699044 4087699064 4087699142 4087699283 4087699387 4087699412 4087699467 4087699588 4087699704 4087699853 4088570378 4088785796 4088785800 4088785815 4088785823 4088868774 4088928233 4088929027 4088929155 4088929320 4088929720 4089069072 4089141696 4089141712 4089141714 4089141721 4089148631 4089148642 4089148864 4089402043 4089402138 4089402199 4089402331 4089402401 4089402418 4089402435 4089402529 4089402547 4089402639 4089402658 4089402686 4089402845 4089402860 4089402878 4089402889 4089402896 4089402957 4089413598 4089413607 4089413613 4089413614 4089413651 4089413655 4089413697 4089413699 4089413706 4089413709 4089413714 4089413716 4089413717 4089413718 4089413731 4089413732 4089413733 4089413734 4089413735 4089413736 4089413738 4089413739 4089413741 4089413742 4089413746 4089413787 4089413816 4089413862 4089413864 4089413865 4089413916 4089413917 4089413922 4089413927 4089413929 4089413934 4089413937 4089413966 4089413967 4089413968 4089413969 4089413973 4089669657 4089925102 4154073089 4154074125 4154160250 4154160442 4154160450 4154160452 4154160705 4154162002 4154162033 4154162038 4154162040 4154162044 4154162048 4154162053 4154162058 4154162066 4154162068 4154162070 4154162073 4154162074 4154162076 4154162096 4154162104 4154162106 4154162111 4154162114 4154162115 4154162117 4154162122 4154162139 4154162142 4154162143 4154162144 4154162146 4154162154 4154162160 4154162161 4154162162 4154162168 4154162169 4154162180 4154162191 4154162204 4154162338 4154162452 4154162458 4154168841 4154168967 4154169788 4154169813 4242853817 4242853857 4243022159 4243326199 4243326499 4243326717 5002694362 5004598539 5004603689 5004615786 5004710701 5004755717 5889267340 5889267345 5889267350 5889267352 5889267358 5889267364 5889267388 5889267407 5889267420 5889267453 5889267455 5889267458 5889267459 5889267461 5889267474 5889267493 5889267495 5889267520 5889267538 5889267550 5889267555 5889267566 5889267569 5889267577 5889267583 5889267589 5889268255 5889269583 5889269839 5889269872 5889269884 5889269891 5889269892 5889269893 5889269900 5889269911 5889269913 5889269914 5889269917 5889269922 5889269924 5889269930 5889269932 5889269937 5889269948 5889269955 5889269965 5889269966 5889269973 5889269997 5889269999 5889270017 5889270026 5889270036 5889270051 5889270064 5889270083 5889270092 5889270127 5889270146 5889270148 5889270160 5889270188 5889270219 5889270240 5889270353 5889270360 5889270388 5889270389 5889270390 5889270402 5889270406 5889270409 5889270416 5889270442 5889270450 5889270460 5889270465 5889270473 5889270476 5889270482 5889270487 5889270490 5889270501 5889270505 5889270512 5889270513 5889270520 5889270539 5889270548 5889270549 5889270560 5889270566 5889270574 6502266187 6502791100 6502791303 6502794673 6502796235 6502797548 6502797568 6502797607 6502797843 6502798260 6502798569 6502798630 6502798678 6502798786 6502889339 6502940869 6503143083 6503143198 6503143207 6503143211 6503143256 6503143273 6503143294 6503143348 6503143366 6503143644 6503143930 6503145071 6503145072 6503145082 6503145094 6503145095 6503145114 6503145115 6503145116 6503145117 6503145118 6503145119 6503145234 6503145235 6503145243 6503145244 6503145245 6503145269 6503145270 6503145271 6503145272 6503145273 6503145290 6503145291 6503145292 6503145293 6503145404 6503145405 6503145406 6503145408 6503145409 6503145410 6503145413 6503145414 6503145415 6503145416 6503145419 6503145420 6503145421 6503145422 6503145423 6503145456 6503145457 6503145458 6503145471 6503145472 6503145473 6503145474 6503145476 6503145477 6503145481 6503145482 6503145483 6503145498 6503145499 6503145501 6503145502 6503145503 6503145508 6503145509 6503145520 6503145521 6503145522 6503145523 6503145536 6503145980 6503148047 6503148062 6503148421 6503148453 6503148517 6503148628 6503148659 6503148672 6503148679 6503148689 6503148723 6503148728 6503148737 6503148780 6503148816 6503148821 6503148836 6503148851 6503148856 6503148857 6503148878 6503148880 6503148885 6503148904 6503148919 6503148921 6503148926 6503148950 6503148970 6503150214 6503150301 6503160239 6503160301 6503160302 6503160443 6503160454 6503160778 6503160869 6503160874 6503160884 6503160907 6503169056 6503169177 6503169351 6503169416 6503169615 6503169713 6503169791 6503169800 6503169808 6503169907 6503187013 6503187201 6503187425 6503187460 6503187682 6503187684 6503187750 6503187773 6503187781 6503187784 6503187879 6503187881 6503188076 6503188081 6503188125 6503188134 6503188138 6503188139 6503188148 6503188200 6503188759 6503188777 6503188999 6503189005 6503189134 6503189135 6503189138 6503189146 6503189150 6503189167 6503189195 6503189203 6503189243 6503189332 6503189525 6503189562 6503189610 6503904834 6503905679 6504047222 6504047429 6504171255 6504171268 6504171382 6504171415 6504171475 6504171488 6504171526 6504171531 6504171615 6504171659 6504171678 6504171690 6504171694 6504171696 6504171706 6504171708 6504171712 6504171733 6504171803 6504171835 6504171837 6504171841 6504171845 6504171878 6504171887 6504171889 6504171902 6504174149 6504174156 6504174170 6504174287 6504174356 6504174446 6504174599 6504174709 6504174766 6504174781 6504174851 6504174918 6504474109 6504474160 6504474227 6504474290 6504474374 6504474559 6504474626 6504474632 6504474665 6504474687 6504474726 6504474784 6504474805 6504474808 6504474810 6504474815 6504474836 6504474854 6504955549 6504955553 6504955970 6504996040 6504996072 6504996106 6504996112 6504996182 6504996228 6504996633 6504996720 6504996737 6504996768 6504996849 6504996900 6504996945 6504996984 6504996987 6504996991 6504997000 6504997017 6504997089 6504997138 6504997142 6504997206 6504997817 6505262167 6505262198 6505262277 6505262329 6505262550 6505262563 6505262864 6505262878 6505262879 6505262900 6505262903 6505262909 6505262963 6505262975 6505262981 6505373222 6505373334 6505373371 6505373886 6505373994 6505642018 6505642054 6505642059 6505642107 6505642108 6505642145 6505642175 6505642226 6505642276 6505642283 6505642524 6505642615 6505642694 6505642700 6505642707 6505642710 6505642823 6505642825 6505642859 6506036523 6506036864 6506055000 6506055586 6506055626 6506055895 6506057631 6506057645 6506237034 6506237040 6506237176 6506237187 6506237196 6506237213 6506237232 6506237296 6506237299 6506237308 6506237331 6506237361 6506237364 6506237398 6506237420 6506237429 6506237450 6506237457 6506237483 6506237562 6506237630 6506237830 6506237948 6506237951 6506237996 6506699605 6506699618 6506699636 6506699775 6506699891 6506954021 6506954152 6506954153 6506954158 6506954173 6506954191 6506954193 6506954195 6506954240 6506954246 6506954247 6506954248 6506954249 6506954250 6506954251 6506954255 6506954256 6506954257 6506954258 6506954259 6506954262 6506954266 6506954270 6506954348 6506954356 6506954357 6506954373 6506954382 6506954389 6506954391 6506954406 6506954474 6506954475 6506954488 6506954528 6506954535 6506954640 6506954659 6506954936 6506954944 6507930038 6507930062 6507930091 6507930289 6507930382 6507930738 6507930880 6507931137 6507931351 6507931819 6507931832 6507932319 6507932749 6507932944 6507932951 6507933006 6507933159 6507933395 6507933566 6507933803 6507933867 6507933988 6507933996 6507934028 6507934144 6507934302 6507934435 6507934476 6507934502 6507934972 6507935309 6507935426 6507935560 6507935674 6507935689 6507935762 6507935925 6507935974 6507935987 6507935988 6507936229 6507936248 6507936443 6507936599 6507936616 6507936617 6507936916 6507936917 6507936930 6507936931 6507937044 6507937098 6507937112 6507937123 6507937165 6507937223 6507937283 6507937304 6507937339 6507937654 6507937748 6507937815 6507938087 6507938180 6507938199 6507938218 6507938229 6507938536 6507938539 6507938614 6507938763 6507938874 6507938895 6507938904 6507938956 6507938973 6507938977 6507938990 6507939046 6507939047 6507939049 6507939061 6507939078 6507939087 6507939099 6507939121 6507939153 6507939154 6507939288 6507939302 6507939437 6507939456 6507939525 6507939826 6507939974 6508103191 6508103303 6508104273 6508105089 6508105577 6508105617 6508105643 6508105737 6508105739 6508105822 6508105912 6508105931 6508106093 6508106349 6508106492 6508106550 6508106805 6508224672 6508224750 6508224767 6508615870 6508615871 6692153407 6692153435 6692153643 6692153651 6692153652 6692153653 6692153654 6692153661 6692153681 6692153682 6692153684 6692153688 6692153693 6692153694 6692153695 6692153696 6692153697 6692153698 6692153747 6692153771 6692153941 6692153980 6692155095 6692155126 6692155128 6692155130 6692155146 6692155147 6692155193 6692155194 6692155195 6692155196 6692155197 6692155198 6692155240 6692155266 6692155267 6692155268 6692155269 6692155270 6692155271 6692155272 6692155273 6692155274 6692155275 6692155276 6692155277 6692155278 6692155279 6692155280 6692155281 6692155282 6692155283 6692155285 6692155286 6692155287 6692155288 6692155289 6692155290 6692155291 6692155292 6692155293 6692155295 6692155296 6692155297 6692155298 6692155299 6692155300 6692155301 6692155302 6692155310 6692155311 6692155312 6692155315 6692155316 6692155318 6692155319 6692155593 6692155594 6692155595 6692155596 6692155597 6692155598 6692155605 6692155612 6692155664 6692155692 6692155824 6692155825 6692155826 6692155827 6692155828 6692155829 6692155830 6692155831 6692155832 6692155833 6692155834 6692155835 6692155836 6692155837 6692155838 6692155839 6692155840 6692155841 6692155842 6692155843 6692155844 6692155845 6692155846 6692155847 6692155848 6692155849 6692155850 6692155851 6692155852 6692155853 6692155859 6692155860 6692155933 6692155934 6692155936 6692155937 6692155941 6692155948 6692155949 6692155950 6692155951 6692155952 6692155953 6692155954 6692155955 6692155956 6692155957 6692155958 6692155959 6692155961 6692155962 6692155963 6692155964 6692155965 6692155966 6692155967 6692155968 6692155969 6692155970 6692155971 6692155978 6692204005 6692204007 6692204008 6692204028 6692204298 6692204410 6692204418 6692204513 6692204654 6692204656 6692204674 6692204735 6692204828 6692204958 6692220300 6692242017 6692242039 6692242063 6692242093 6692242101 6692242135 6692242194 6692242227 6692242263 6692242271 6692242299 6692242313 6692242444 6692242492 6692242494 6692242537 6692242541 6692242570 6692242597 6692242823 6692242901 6692242913 6692242922 6692242923 6692242946 6692250298 6692250303 6692250490 6692251013 6692251271 6692251354 6692251474 6692251552 6692251561 6692251579 6692251645 6692251769 6692251831 6692251873 6692251999 6692302031 6692302038 6692302093 6692302105 6692302108 6692302109 6692302159 6692360168 6692360239 6692360290 6692360345 6692360366 6692360402 6692360424 6692360444 6692360465 6692360466 6692360491 6692360554 6692360572 6692360573 6692360596 6692360663 6692360932 6692360955 6692361103 6692361279 6692361294 6692361356 6692361374 6692361378 6692361388 6692361397 6692361434 6692361506 6692361652 6692367506 6692367515 6692367764 6692420050 6692420106 6692420121 6692420397 6692420469 6692420568 6692421495 6692421569 6692421622 6692421629 6692429366 6692429403 6692429499 6692429501 6692429572 6692429887 6692429959 6692431087 6692431351 6692431382 6692431393 6692431419 6692431485 6692431801 6692431843 6692480464 6692480536 6692480542 6692480544 6692480564 6692480693 6692480998 6692481503 6692481555 6692481575 6692481576 6692481583 6692481718 6692481837 6692481839 6692481880 6692481998 6692486055 6692486108 6692486540 6692486551 6692486648 6692492147 6692492170 6692492199 6692492234 6692492382 6692492396 6692492508 6692492642 6692492643 6692492644 6692492645 6692492646 6692492647 6692492648 6692492649 6692492650 6692492651 6692492652 6692492653 6692492654 6692492655 6692492656 6692492657 6692511592 6692686560 6692686594 6692686613 6692686659 6692686995 6692686996 6692686998 6692725429 6692725965 6692726536 6692726740 6692733001 6692733209 6692822222 6692822223 6692822224 6692822225 6692822226 6692822227 6692822228 6692822229 6692822230 6692822232 6692822234 6692822235 6692822236 6692822237 6692822238 6692822239 6692822242 6692822243 6692822251 6692822252 6692822253 6692822254 6692822299 6692822320 6692822323 6692822324 6692822325 6692822326 6692822327 6692822328 6692822329 6692822330 6692822331 6692822332 6692822333 6692822334 6692822335 6692822336 6692822337 6692822338 6692822339 6692822340 6692822341 6692822342 6692822343 6692822344 6692822345 6692822346 6692822347 6692822348 6692822349 6692822350 6692822351 6692822352 6692822353 6694540181 6694540224 6694540274 6694540342 6694540381 6694540382 6694540463 6694540467 6694540468 6694540469 6694540470 6694540471 6694540472 6694540473 6694540474 6694540475 6694540476 6694540477 6694540478 6694540479 6694540480 6694540481 6694540482 6694540483 6694540484 6694540485 6694540486 6694540487 6694540488 6694540489 6694540490 6694540491 6694540492 6694540493 6694540494 6694540495 6694540496 6694540502 6694540503 6694540505 6694540507 6694540508 6694540509 6694540510 6694540511 6694540512 6694540513 6694540536 6694540537 6694540555 6694540556 6694540557 6694540558 6694540559 6694540560 6694540561 6694540562 6694540563 6694540564 6694540565 6694540566 6694540567 6694540568 6694540569 6694540570 6694540571 6694540572 6694540573 6694540574 6694540575 6694540576 6694540577 6694540578 6694540579 6694540580 6694540581 6694540582 6694540583 6694540584 6694540585 6694540586 6694540587 6694540588 6694540589 6694540590 6694540591 6694540592 6694540593 6694540594 6694540595 6694540596 6694540597 6694540598 6694540599 6694540600 6694540601 6694540602 6694540603 6694540604 6694540605 6694540606 6694540607 6694540608 6694540609 6694540610 6694540611 6694540612 6694540613 6694540614 6694540615 6694540616 6694540617 6694540618 6694540619 6694540620 6694540621 6694540622 6694540623 6694540624 6694540625 6694540626 6694540627 6694540628 6694540629 6694540630 6694540631 6694540893 6694541089 6694541090 6694541091 6694541092 6694541097 6694541098 6694541099 6694541100 6694541101 6694541102 6694541103 6694541104 6694541105 6694541106 6694541107 6694541108 6694541109 6694541110 6694541111 6694541112 6694541113 6694541114 6694541115 6694541116 6694541117 6694541118 6694541119 6694541120 6694541121 6694541171 6694541172 6694541173 6694541174 6694541175 6694541176 6694541177 6694541178 6694541179 6694541180 6694541181 6694541182 6694541183 6694541184 6694541185 6694541186 6694541187 6694541188 6694541189 6694541190 6694541191 6694541192 6694541193 6694541194 6694541195 6694541196 6694541197 6694541198 6694541199 6694541200 6694541201 6694541202 6694541203 6694541204 6694541205 6694541567 6694541568 6694541569 6694541570 6694541589 6694541590 6694541591 6694541592 6694541593 6694541594 6694541595 6694541596 6694541597 6694541598 6694541599 6694541600 6694541601 6694541602 6694541603 6694541604 6694541605 6694541606 6694541607 6694541608 6694541609 6694541610 6694541611 6694541612 6694541613 6694541614 6694541615 6694541616 6694541617 6694541618 6694541619 6694541620 6694541621 6694541622 6694541623 6694541624 6694541625 6694541626 6694541631 6694542938 6694542939 6694542940 6694542941 6694542942 6694542943 6694542944 6694542945 6694542946 6694542947 6694542948 6694542949 6694542950 6694542951 6694542952 6694542953 6694542954 6694542955 6694542956 6694542957 6694542958 6694542959 6694542960 6694542961 6694542962 6694542963 6694542964 6694542965 6694542966 6694542967 6694542968 6694542969 6694542970 6694542971 6694542972 6694542973 6694542974 6694542975 6694542976 6694542977 6694542978 6696001001 6696001127 6696001773 6696001948 6696001962 6696001968 6696001969 6696001972 6696001974 6696001978 6696001983 6696001990 6696001996 6696007021 6696007526 6696007529 6696007532 6696007533 6696007537 6696007539 6696007548 6696007550 6696007555 6696007573 6696007580 6696007583 ));0

File.open('/tmp/pre_map_devs', 'w') { |file| file.write devs.to_yaml }

devs.each do |d|
  wn = d.mdn.to_s[0..2] + '-' + d.mdn.to_s[3..5] + '-' + d.mdn.to_s[6..9]
  ca = PublicBillingDatum.where(wireless_number: wn).order(created_at: :asc).first&.created_at
  next if (ca.nil? || (d.created_at < ca))

  d.created_at = ca
  d.save
end

devs.reload
File.open('/tmp/post_map_devs', 'w') { |file| file.write devs.to_yaml }
