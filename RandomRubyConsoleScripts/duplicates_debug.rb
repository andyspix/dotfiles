look_at = RatePlan.find(1479).devices.select do |d|
  Device.joins(:assignment).where("pws_note like '%#{d.device_name}%'").where.not('assignments.rate_plan_id': 1479).count.positive?
end

look_at_ids = [160155, 167120, 169925, 170093, 170095, 170099, 170103, 170106, 170113, 170121, 170697, 170707, 170708, 170716, 170748, 170757, 170759, 170794, 170830, 170831, 174123, 180798, 180841, 183974, 185986, 186015, 194283, 315685, 315716, 315717, 316918, 317069, 318299, 318325, 318515, 321460, 321504, 321622, 321915, 321963, 322446, 323485, 323530, 324333, 329407, 334258, 334362, 334505, 335237, 336532, 340753, 340754, 340755, 354044, 354045, 354046, 354981, 359120, 365786, 380485, 380486, 380487, 380488, 380489, 380490, 380491, 380492, 380493, 380494, 380495, 380498, 380499, 386333, 386651, 386992, 388042, 388043, 388044, 391707, 399246, 399247, 399248, 399249, 399250, 410687, 410689, 417224, 420453, 420454, 420456, 420457, 420459, 420460, 420461, 420462, 420463, 420464, 420465, 420466, 420467, 420468, 420469, 420470, 420471, 420472, 420473, 420474, 420475, 420476, 420477, 420478, 420479, 420480, 420481, 420482, 420483, 420484, 420485, 420486, 420487, 420488, 420489, 420490, 420491, 420492, 420493, 420494, 420495, 420496, 420497, 420498, 420499, 420500, 420501, 420502, 420503, 420504, 420505, 420506, 420507, 420508, 420509, 420510, 420511, 420512, 420513, 420514, 420515, 420516, 420517, 420518, 420519, 420520, 420521, 420522, 420523, 420524, 420525, 420526, 420527, 420528, 420529, 420530, 420531, 420532, 420533, 420534, 420535, 420536, 420537, 420538, 420539, 420540, 420541, 420542, 420543, 420544, 420545, 420546, 420616, 420618, 420619, 420620, 420621, 420622, 420623, 420624, 434559]

# duplicate_id, regular_id
pairs = [[160155, 413603], [167120, 221983], [169925, 289414], [170093, 212804], [170095, 289098], [170099, 344489], [170103, 350978], [170106, 308442], [170113, 212935], [170121, 213532], [170697, 350979], [170707, 265540], [170708, 221984], [170716, 212228], [170748, 239945], [170757, 356750], [170759, 225938], [170794, 289433], [170830, 202031], [170831, 289415], [174123, 289416], [183974, 388050], [185986, 359121], [186015, 382156], [194283, 184956], [315685, 187387], [315716, 198990], [315717, 202469], [316918, 381447], [317069, 344655], [318299, 379667], [318325, 380502], [318515, 380503], [321460, 432232], [321504, 425098], [321622, 425100], [321915, 432233], [321963, 425099], [322446, 425101], [323485, 425097], [323530, 433593], [324333, 433594], [329407, 399825], [334258, 354582], [334362, 381832], [334505, 381448], [335237, 380504], [336532, 425096], [340753, 203752], [340754, 211988], [340755, 212136], [354044, 316566], [354045, 327388], [354046, 316081], [354981, 316969], [359120, 320681], [365786, 207005], [380485, 148695], [380486, 149225], [380487, 149356], [380488, 149780], [380489, 149781], [380490, 150660], [380491, 37958], [380492, 57592], [380493, 57595], [380494, 57593], [380495, 57587], [380498, 57598], [380499, 57600], [386333, 323942], [386651, 344425], [386992, 321861], [388042, 325377], [388043, 333907], [388044, 320818], [391707, 338772], [399246, 195663], [399247, 316876], [399248, 318990], [399249, 329786], [399250, 334436], [410687, 165775], [410689, 198380], [417224, 410909], [420453, 318912], [420454, 321380], [420456, 325826], [420457, 150859], [420459, 320058], [420460, 320231], [420461, 320388], [420462, 320595], [420463, 320647], [420464, 320666], [420465, 320674], [420466, 320679], [420467, 320678], [420468, 320698], [420469, 320711], [420470, 320720], [420471, 320751], [420472, 320912], [420473, 322256], [420474, 323173], [420475, 323486], [420476, 323973], [420477, 324021], [420478, 324414], [420479, 324474], [420480, 324550], [420481, 324654], [420482, 324781], [420483, 324808], [420484, 324812], [420485, 324887], [420486, 324976], [420487, 325146], [420488, 325173], [420489, 325305], [420490, 325328], [420491, 325339], [420492, 325343], [420493, 325364], [420494, 325453], [420495, 325468], [420496, 325691], [420497, 325726], [420498, 326000], [420499, 326162], [420500, 326212], [420501, 326349], [420502, 326370], [420503, 326376], [420504, 326381], [420505, 326416], [420506, 326457], [420507, 326508], [420508, 326614], [420509, 326676], [420510, 326694], [420511, 326700], [420512, 326706], [420513, 326741], [420514, 326819], [420515, 326918], [420516, 326924], [420517, 326963], [420518, 327051], [420519, 327061], [420520, 327065], [420521, 327109], [420522, 327110], [420523, 327124], [420524, 327137], [420525, 327220], [420526, 327225], [420527, 327230], [420528, 327498], [420529, 327768], [420530, 328151], [420531, 328201], [420532, 331147], [420533, 331259], [420534, 331375], [420535, 331735], [420536, 331837], [420537, 331843], [420538, 331855], [420539, 331925], [420540, 332092], [420541, 332395], [420542, 334001], [420543, 334010], [420544, 334046], [420545, 334447], [420546, 334618], [420616, 195531], [420618, 195400], [420619, 195420], [420620, 195427], [420621, 195468], [420622, 195490], [420623, 195523], [420624, 195541], [434559, 399814]]

report = [%w(dupId realId dupDevName realDevName dupNote realNote dupPwsNote realPwsNote dupIpAddress realIpAddress dupRpName realRpName dupBytes RealBytes dupState realState)]
pairs.each do |x|
  d0 = Device.find(x[0])
  d1 = Device.find(x[1])
  report << [
    d0.id,
    d1.id,
    d0.device_name,
    d1.device_name,
    d0.note,
    d1.note,
    d0.pws_note,
    d1.pws_note,
    d0.ip_address,
    d1.ip_address,
    d0.rate_plan.name,
    d1.rate_plan.name,
    d0.bytes_used,
    d1.bytes_used,
    d0.state,
    d1.state
  ]
end

=> [[160155, 413603]]

pairs[1..185].each do |x|
  d0 = Device.find(x[0])
  d1 = Device.find(x[1])
  d0.rate_plan = d1.rate_plan
  d1.rate_plan = RatePlan.duplicate
end
