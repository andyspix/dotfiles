def devs
  Device.where(device_name: %w(89148000003228849845 89148000003228849829 89148000003226688179 89148000003226688237 89148000003218533615 89148000003218533870 89148000003218538200 89148000003218538895 89148000003218533730 89148000003218538135 89148000003218538697 89148000003218532195 89148000003218533953 89148000003218533813 89148000003218532187 89148000003218538242 89148000003218541931 89148000003218538689 89148000003218538804 89148000003218532088 89148000004100750663 89148000003218539042 89148000003218580350 89148000003218538101 89148000003218532153 89148000002044782982 89148000003218533573 89148000002044782602 89148000002044782792 89148000002044782826 89148000002044779368 89148000003218533912 89148000002044783055 89148000002044778790 89148000003218562614 89148000002044782909 89148000003218532708 89148000002377974388 89148000003218532278 89148000002044778808 89148000003218562937 89148000003218532294 89148000003218562986 89148000003218532252 89148000002377974487 89148000003218562309 89148000002044779202 89148000002892084580 89148000002377974503 89148000003218568272 89148000003218532518 89148000002044783204 89148000002044782875 89148000003218562150 89148000002377974180 89148000003218532815 89148000002044778477 89148000002377974339 89148000002377972903 89148000003218562721 89148000002044782693 89148000003218568355 89148000003218568918 89148000002377974255 89148000002892084598 89148000002044782255 89148000002377972416 89148000002044783253 89148000003218568405 89148000003218568082 89148000003218568249 89148000002377972077 89148000001797889382 89148000002044782495 89148000002044782313 89148000002044783196 89148000002044783261 89148000002044782289 89148000002377968885 89148000002044778428 89148000002201187520 89148000002044778451 89148000002044778493 89148000002044779525 89148000002377973901 89148000002377974537 89148000002044778436 89148000002044782859 89148000002044782669 89148000002044778584 89148000002044778600 89148000002044782503 89148000002044782321 89148000002044778485 89148000002044782347 89148000002044783279 89148000002377972028 89148000002044782719 89148000002044778618 89148000002377972010 89148000002044782362 89148000002377974156 89148000003218568843 89148000002201187744 89148000002044783238 89148000002377974404 89148000002044778469 89148000002044778626 89148000002377974362 89148000002044783154 89148000002044782545 89148000002044778568 89148000002044783303 89148000002044782727 89148000002377974511 89148000002377974206 89148000002377971988 89148000002377974065 89148000002044782487 89148000002044778527 89148000004124136535 89148000004124140727 89148000004124137780 89148000004124138101 89148000004124138051 89148000004124140917 89148000004124141527 89148000003228829391 89148000003477692391 89148000000407982272 89148000004124137897 89148000000407982389 89148000003228842055 89148000000408007087 89148000000408007202 89148000004124036305 89148000003218538010 89148000003228845447 89148000004124139463 89148000004440724105 89148000004124139422 89148000000408006147 89148000000407982413 89148000000407988485 89148000004124139414 89148000003228845405 89148000000407982330 89148000004124139455 89148000002377974719 89148000002377973018 89148000004124139448 89148000002377973927 89148000002377973828 89148000002377972796 89148000000767787931 89148000000407982264 89148000002377973216 89148000002377972929 89148000002377973117 89148000000767787949 89148000002377972820 89148000003228826645 89148000002377972986 89148000002377973414 89148000003228844366 89148000000386687967 89148000002377973919 89148000002377973083 89148000002377972598 89148000002377973588 89148000000386687546 89148000002377973885 89148000002377965311 89148000003228828971 89148000003228826579 89148000000767787956 89148000002377972689 89148000000386687512 89148000003228840869 89148000002377965113 89148000003226684038 89148000002377965501 89148000003226683998 89148000000411298889 89148000000386687652 89148000003228846221 89148000002892081727 89148000002377972622 89148000003226684046 89148000002377972523 89148000003228829144 89148000002377973620 89148000002377973398 89148000002377968968 89148000003228840802 89148000003218534985 89148000003228840844 89148000002377968869 89148000003228825449 89148000002044778956 89148000002377967192 89148000002377972374 89148000002377967861 89148000003218541642 89148000002377968828 89148000002377972119 89148000002377968877 89148000002377967812 89148000003228820705 89148000002377967580 89148000000411169049 89148000002044778931 89148000002044778972 89148000002044778907 89148000002201187660 89148000002201187652 89148000002377967010 89148000003228846197 89148000004023363461 89148000002377967549 89148000002377966996 89148000002377967754 89148000002377972143 89148000002377967325 89148000002377974628 89148000002377974040 89148000002201188007 89148000002044779459 89148000003228846171 89148000002377965808 89148000002377972192 89148000002377967358 89148000002377967721 89148000002377967341 89148000003218541253 89148000002201187678 89148000000411289482 89148000002377967481 89148000004100750887 89148000003218537160 89148000000411193270 89148000002377967507 89148000003226684012 89148000002377967366 89148000002377967713 89148000002377967119 89148000002892082857 89148000002044782990 89148000000386687702 89148000002377974651 89148000000411301188 89148000002892082865 89148000002377965790 89148000003228846205 89148000000411301550 89148000000411169155 89148000002377965915 89148000000411301204 89148000000411299077 89148000002377967655 89148000003226687130 89148000002377972333 89148000000408006865 89148000003218537178 89148000002892081826 89148000002377965584 89148000002377967424 89148000000411064711 89148000002044778659 89148000002377967556 89148000002377965949 89148000002377965683 89148000003228846247 89148000002377967416 89148000002044778899 89148000002892081933 89148000002377972267 89148000000411299457 89148000000411301634 89148000002377967150 89148000002377967267 89148000002377967077 89148000002377967226 89148000002377967069 89148000000407988022 89148000002892081925 89148000002044782552 89148000002377967952 89148000000407988030 89148000000411288518 89148000000411192777 89148000002377965774 89148000002377965626 89148000002377967911 89148000004100691719 89148000002377967259 89148000002892082899 89148000002377967218 89148000002377967242 89148000002377967085 89148000002377967275 89148000000386687579 89148000000385222378 89148000000411289722 89148000000411333579 89148000003218541063 89148000002377965725 89148000000407988170 89148000003218537665 89148000002377967903 89148000000411334023 89148000002377974594 89148000002044779491 89148000002377965873 89148000002377967044 89148000002044782396 89148000003218541709 89148000002377967895 89148000003477723907 89148000003218537129 89148000000411175632 89148000003477734250 89148000002377965386 89148000002377973174 89148000000604411422 89148000002377965394 89148000000411287569 89148000000411299556 89148000000411171235 89148000002377965451 89148000002377965402 89148000002377965410 89148000002377971384 89148000000411287767 89148000002377967705 89148000002377967739 89148000002377971905 89148000002377971913 89148000000386694005 89148000000411287353 89148000002377965014 89148000002892078236 89148000000385803151 89148000002377971947 89148000002892078434 89148000000411058796 89148000002377965436 89148000000386234190 89148000000386230875 89148000000411171748 89148000000411331482 89148000002892085074 89148000000385803342 89148000000386234893 89148000000386233911 89148000000386235262 89148000004124140867 89148000000411171755 89148000000411335251 89148000000411171565 89148000000411335210 89148000000386687298 89148000002892078228 89148000002377970196 89148000000411171391 89148000000385807343 89148000000411172019 89148000000411171821 89148000000411058556 89148000000385810990 89148000000385803227 89148000000386234679 89148000002892078202 89148000000385217675 89148000000386231360 89148000000386234364 89148000002377970048 89148000002377970535 89148000000386234802 89148000000411334106 89148000002377970600 89148000002377970543 89148000000411331813 89148000000411171409 89148000002377970162 89148000002377970964 89148000000386233952 89148000000385804134 89148000000411302095 89148000000386231212 89148000000411058697 89148000000386233648 89148000000386233630 89148000004100750622 89148000000386231444 89148000000386234208 89148000000411171953 89148000004385966240 89148000003228849878 89148000003218537905 89148000004440715236 89148000000411058895 89148000004440715251 89148000003218537517 89148000003218541469 89148000003226688351 89148000003218566490 89148000004243580688 89148000003218566433 89148000003218541840 89148000003228829508 89148000003218541873 89148000003477708320 89148000003218567035 89148000003218541824 89148000003218566912 89148000003228829540 89148000002377970816 89148000002892085421 89148000002377970014 89148000002377970097 89148000002377970675 89148000002377970147 89148000003228825282 89148000002892084960 89148000002377970642 89148000002892084937 89148000002377970006 89148000002377970337 89148000002377970303 89148000000282853036 89148000002377970527 89148000002377970089 89148000004124140859 89148000002377970451 89148000000386687249 89148000002377970121 89148000000411287833 89148000002377970212 89148000003173333811 89148000002377970907 89148000000408078997 89148000000408074418 89148000002377970519 89148000004243580779 89148000000408078633 89148000000408079227 89148000002377973521 89148000002892085298 89148000000232745449 89148000000408004795 89148000002377970840 89148000003218534035 89148000002377970766 89148000000282853085 89148000002892085496 89148000002377970980 89148000002377970774 89148000000411171516 89148000000408078765 89148000002892085264 89148000002377971483 89148000002377971442 89148000004100750796 89148000000292198000 89148000000292198059 89148000000282853242 89148000002377970691 89148000002377973596 89148000002377971590 89148000002201187389 89148000002377970873 89148000002377971244 89148000002377971558 89148000000408078666 89148000002377971616 89148000002377971640 89148000002892084408 89148000002377971038 89148000003298352589 89148000002201189989 89148000003218534142 89148000000386230776 89148000002377970923 89148000002377970915 89148000003218534308 89148000002377971004 89148000002377971012 89148000002377970790 89148000000386687447 89148000000386687306 89148000002377971210 89148000002377970758 89148000002377970485 89148000002377971426 89148000000386233671 89148000002377971418 89148000002377970345 89148000000408079185 89148000002377970493 89148000000411288328 89148000000386693288 89148000002377970857 89148000002377971517 89148000000232745399 89148000003218566557 89148000003477727452 89148000004124140628 89148000000190091182 89148000004124140610 89148000002377971046 89148000004100750838 89148000004100750416 89148000004124008650 89148000000292198364 89148000002377970782 89148000003218563588 89148000003218564719 89148000003218564677 89148000003218564685 89148000003218563463 89148000003218564834 89148000003218563877 89148000003218564750 89148000003218569098 89148000003218569080 89148000003218569346 89148000003218576630 89148000003218576325 89148000003218576853 89148000003218576895 89148000003218569825 89148000003218576382 89148000003218569957 89148000003218576838 89148000003218569403 89148000003218576424 89148000003218576309 89148000003477727437 89148000003218576820 89148000003218576390 89148000003218576978 89148000003228848995 89148000003228849050 89148000003218573678 89148000004440711730 89148000003228830076 89148000003228850421 89148000003228840919 89148000003228830134 89148000003228843624 89148000003228846619 89148000003228846650 89148000004434332667 89148000004434339985 89148000004434332295 89148000004434327550 89148000004440726332 89148000004598744988 89148000004917892054 89148000001938692125 89148000004917926282 89148000004917881495 89148000004917200860 89148000004917201124 89148000004917200993 89148000004917201173 89148000004917201207 89148000004917390232 89148000005843189531 89148000005843190372 89148000005843189937 89148000005843130154 89148000005843140179 89148000005843142126 89148000005843142357 89148000005843250903 89148000004918069785 89148000004918070130 89148000004918070148 89148000005843262809 89148000005843262874 89148000005843263070 89148000005843263153 89148000005843263294 89148000005843261538 89148000004918068688 89148000004918069363 89148000005843262031 89148000005843262064 89148000003477722024 89148000004918082424 89148000004917575733 89148000000386230578 89148000004917307590 89148000004917307608 89148000004917462361 89148000004917990593 89148000006838881207 89148000006838881199 89148000007032012896 89148000007032012862 89148000007032012946 89148000007032012920 89148000007032012912 89148000007032012938 89148000007032012870 89148000007032012888 89148000007032012854 89148000006840280331)
end

def gen_report
  months = (Date.parse('Jan, 1, 2021')..(Date.today)).to_a.reject { |d| d.day != 1 }

  report = [['DeviceName', *months]]
  devs.each do |d|
    line = [d.device_name]
    months.each { |m| line += [d.monthly_data_usages.where(date_for: m).first&.bytes_used&.to_i] }
    report << line
  end
  report
end



